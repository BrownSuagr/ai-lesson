
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../img/logo.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.11">
    
    
      
        <title>案例-顾客数据聚类分析 - 机器学习讲义</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50e68009.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#-" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../index.html" title="机器学习讲义" class="md-header__button md-logo" aria-label="机器学习讲义" data-md-component="logo">
      
  <img src="../img/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            机器学习讲义
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              案例-顾客数据聚类分析
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="清空当前内容" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
    <img src="../assets/images/logo.svg" height="45px" alt="logo">

  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="机器学习讲义" class="md-nav__button md-logo" aria-label="机器学习讲义" data-md-component="logo">
      
  <img src="../img/logo.png" alt="logo">

    </a>
    机器学习讲义
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          1、机器学习概述
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="1、机器学习概述" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          1、机器学习概述
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01-%E5%89%8D%E7%BD%AE%E6%A6%82%E5%BF%B5/00-README.html" class="md-nav__link">
        01_内容介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01-%E5%89%8D%E7%BD%AE%E6%A6%82%E5%BF%B5/01-%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E6%A6%82%E5%BF%B5.html" class="md-nav__link">
        02_人工智能概念
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01-%E5%89%8D%E7%BD%AE%E6%A6%82%E5%BF%B5/02-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%A6%82%E5%BF%B5.html" class="md-nav__link">
        03_机器学习概念
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01-%E5%89%8D%E7%BD%AE%E6%A6%82%E5%BF%B5/03-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%88%86%E7%B1%BB.html" class="md-nav__link">
        04_机器学习分类
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01-%E5%89%8D%E7%BD%AE%E6%A6%82%E5%BF%B5/05-%E6%8B%9F%E5%90%88%E9%97%AE%E9%A2%98.html" class="md-nav__link">
        05_拟合问题
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01-%E5%89%8D%E7%BD%AE%E6%A6%82%E5%BF%B5/06-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%99%A8%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html" class="md-nav__link">
        06_机器学习开发环境
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          2、K近邻
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="2、K近邻" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          2、K近邻
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02-K%E8%BF%91%E9%82%BB/00-README.html" class="md-nav__link">
        01_内容介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02-K%E8%BF%91%E9%82%BB/01-K%E8%BF%91%E9%82%BB%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86.html" class="md-nav__link">
        02_K近邻算法原理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02-K%E8%BF%91%E9%82%BB/02-%E8%B7%9D%E7%A6%BB%E7%9A%84%E5%BA%A6%E9%87%8F%E6%96%B9%E6%B3%95.html" class="md-nav__link">
        03_距离的度量方法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02-K%E8%BF%91%E9%82%BB/03-%E5%BD%92%E4%B8%80%E5%8C%96%E5%92%8C%E6%A0%87%E5%87%86%E5%8C%96.html" class="md-nav__link">
        04_归一化和标准化
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02-K%E8%BF%91%E9%82%BB/04-K%E8%BF%91%E9%82%BB%E7%AE%97%E6%B3%95API.html" class="md-nav__link">
        05_K近邻算法API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02-K%E8%BF%91%E9%82%BB/06-%E5%88%86%E7%B1%BB%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E6%96%B9%E6%B3%95.html" class="md-nav__link">
        06_分类模型评估方法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02-K%E8%BF%91%E9%82%BB/05-K%E5%80%BC%E9%80%89%E6%8B%A9%E9%97%AE%E9%A2%98.html" class="md-nav__link">
        07_K值选择问题
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02-K%E8%BF%91%E9%82%BB/07-%E6%A1%88%E4%BE%8B-%E6%89%8B%E5%86%99%E6%95%B0%E5%AD%97%E8%AF%86%E5%88%AB.html" class="md-nav__link">
        08_案例-手写数字识别
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          3、线性回归
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="3、线性回归" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          3、线性回归
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/00-README.html" class="md-nav__link">
        01_内容介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/01-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E5%8E%9F%E7%90%86.html" class="md-nav__link">
        02_线性回归原理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/03-%E6%AD%A3%E8%A7%84%E6%96%B9%E7%A8%8B.html" class="md-nav__link">
        03_损失函数和正规方程
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/%E6%B1%82%E5%AF%BC.html" class="md-nav__link">
        04_求导
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/04-%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%952.html" class="md-nav__link">
        05_梯度下降法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/05-%E5%85%B6%E4%BB%96%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%96%B9%E6%B3%95.html" class="md-nav__link">
        06_其他梯度下降方法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/%E5%9B%9E%E5%BD%92%E9%97%AE%E9%A2%98%E8%AF%84%E4%BC%B0.html" class="md-nav__link">
        07_回归问题评估
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/06-%E6%AD%A3%E5%88%99%E5%8C%96.html" class="md-nav__link">
        08_过拟合欠拟合与正则化
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/07-%E6%A1%88%E4%BE%8B-%E6%B3%A2%E5%A3%AB%E9%A1%BF%E6%94%BE%E4%BB%B7%E9%A2%84%E6%B5%8B.html" class="md-nav__link">
        09_案例-波士顿房价预测
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          4、逻辑回归
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="4、逻辑回归" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          4、逻辑回归
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/00-README.html" class="md-nav__link">
        01_内容介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/01-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E7%AE%80%E4%BB%8B.html" class="md-nav__link">
        02_逻辑回归介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/03-%E6%A1%88%E4%BE%8B-%E7%99%8C%E7%97%87%E5%88%86%E7%B1%BB%E9%A2%84%E6%B5%8B.html" class="md-nav__link">
        03_案例-癌症分类预测
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/04-%E5%88%86%E7%B1%BB%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87.html" class="md-nav__link">
        04_分类评估指标
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/06-%E7%BB%83%E4%B9%A0-%E7%94%B5%E4%BF%A1%E5%AE%A2%E6%88%B7%E6%B5%81%E5%A4%B1.html" class="md-nav__link">
        05_案例-电信客户流失
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          5、决策树
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="5、决策树" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          5、决策树
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E5%86%B3%E7%AD%96%E6%A0%91/00-README.html" class="md-nav__link">
        01_内容介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E5%86%B3%E7%AD%96%E6%A0%91/01-%E5%86%B3%E7%AD%96%E6%A0%91%E4%BB%8B%E7%BB%8D.html" class="md-nav__link">
        02_决策树介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E5%86%B3%E7%AD%96%E6%A0%91/03-ID3%E5%86%B3%E7%AD%96%E6%A0%91.html" class="md-nav__link">
        03_ID3决策树
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E5%86%B3%E7%AD%96%E6%A0%91/04-C4.5%E5%86%B3%E7%AD%96%E6%A0%91.html" class="md-nav__link">
        04_C4.5决策树
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E5%86%B3%E7%AD%96%E6%A0%91/05-CART%E5%86%B3%E7%AD%96%E6%A0%91.html" class="md-nav__link">
        05_CART决策树
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E5%86%B3%E7%AD%96%E6%A0%91/06-%E5%9B%9E%E5%BD%92%E5%86%B3%E7%AD%96%E6%A0%91.html" class="md-nav__link">
        06_回归决策树
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E5%86%B3%E7%AD%96%E6%A0%91/07-%E5%89%AA%E6%9E%9D.html" class="md-nav__link">
        07_剪枝
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E5%86%B3%E7%AD%96%E6%A0%91/08-%E6%A1%88%E4%BE%8B-%E6%B3%B0%E5%9D%A6%E5%B0%BC%E5%85%8B%E5%8F%B7%E7%94%9F%E5%AD%98%E9%A2%84%E6%B5%8B.html" class="md-nav__link">
        08_案例-泰坦尼克号生存预测
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          6、朴素贝叶斯
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="6、朴素贝叶斯" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          6、朴素贝叶斯
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06-%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF/00-README.html" class="md-nav__link">
        01_内容介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06-%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF/01-%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%8E%9F%E7%90%86.html" class="md-nav__link">
        02_朴素贝叶斯原理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06-%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF/02-%E6%A1%88%E4%BE%8B-%E5%95%86%E5%93%81%E8%AF%84%E8%AE%BA%E5%88%86%E7%B1%BB.html" class="md-nav__link">
        03_案例-垃圾邮件分类
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          7、支持向量机
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="7、支持向量机" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          7、支持向量机
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../07-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/00-README.html" class="md-nav__link">
        01_内容介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../07-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/01-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E5%BC%95%E5%85%A5.html" class="md-nav__link">
        02_支持向量引入
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../07-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/02-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%A6%82%E5%BF%B5.html" class="md-nav__link">
        03_支持向量概念
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../07-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/04-%E6%A0%B8%E6%96%B9%E6%B3%95.html" class="md-nav__link">
        04_核方法和损失函数
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../07-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/06-%E6%A1%88%E4%BE%8B-%E9%B8%A2%E5%B0%BE%E8%8A%B1%E7%A7%8D%E7%B1%BB%E9%A2%84%E6%B5%8B.html" class="md-nav__link">
        05_案例-鸢尾花种类预测
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          8、聚类算法
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="8、聚类算法" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          8、聚类算法
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="00-README.html" class="md-nav__link">
        01_内容介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="section1.html" class="md-nav__link">
        02_聚类概述
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="section2.html" class="md-nav__link">
        03_KMeans API介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="section3.html" class="md-nav__link">
        04_KMeans实现流程
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="section4.html" class="md-nav__link">
        04_聚类效果评估
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="04-%E7%89%B9%E5%BE%81%E9%99%8D%E7%BB%B4.html" class="md-nav__link">
        05_特征降维
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="section5.html" class="md-nav__link">
        06_案例-顾客数据聚类分析
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          9、集成学习
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="9、集成学习" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          9、集成学习
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/00-README.html" class="md-nav__link">
        01_内容介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/01-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0%E9%97%AE%E9%A2%98.html" class="md-nav__link">
        02_集成学习问题
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/02-Bagging%E5%92%8C%E9%9A%8F%E6%9C%BA%E6%A3%AE%E6%9E%97.html" class="md-nav__link">
        03_Bagging和随机森林
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/03-Boosting%E5%92%8CAdaBoost.html" class="md-nav__link">
        04_Boosting和AdaBoost
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/04-%E6%A1%88%E4%BE%8B-%E8%BD%A6%E8%BE%86%E8%B4%B7%E6%AC%BE%E8%BF%9D%E7%BA%A6%E9%A2%84%E6%B5%8B.html" class="md-nav__link">
        05_案例-车辆贷款违约预测
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/05-GBDT.html" class="md-nav__link">
        06_GBDT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/06-XGBoost_1.html" class="md-nav__link">
        07_XGBoost
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/07-%E6%A1%88%E4%BE%8B-%E7%BA%A2%E9%85%92%E5%93%81%E8%B4%A8%E5%88%86%E7%B1%BB.html" class="md-nav__link">
        08_案例-红酒品质分类
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    案例业务背景介绍
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    4.1 数据加载
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#42-eda_" class="md-nav__link">
    4.2 EDA_单变量分析
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#43-eda" class="md-nav__link">
    4.3 EDA 多变量分析
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#44-kmeans" class="md-nav__link">
    4.4 KMeans聚类
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#45" class="md-nav__link">
    4.5 结果解读
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#45_1" class="md-nav__link">
    4.5 总结
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="-">案例-顾客数据聚类分析<a class="headerlink" href="#-" title="Permanent link">&para;</a></h1>
<h3 id="_1">案例业务背景介绍<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>某传统综合性购物中心，集服装，鞋帽，母婴，亲子，娱乐，早教，休闲餐饮于一身。随着集团数字化进程的推进，最近两年间商场实行了数字化会员制度。会员可以通过手机号消费积分。而集团的数据库里也可以通收集会员的基本信息，交易行为等数据分析用户的偏好和类型。作为数据分析师，接到了来自营销部门的一份需求：研究商场会员的人群特征。</p>
</li>
<li>
<p>营销同事均为公司老员工，属于传统零售业转型，对于目前商场客人大致分为几类只是通过平时的观察主观归纳总结：</p>
</li>
<li>
<p>有些学生模样的年轻人经常来吃午餐</p>
</li>
<li>周末有年轻的父母会带小孩儿来上培训班</li>
<li>
<p>工作日的白天有些年龄偏大的顾客在商场闲逛</p>
</li>
<li>
<p>我们需要通过数据分析进一步清晰商场注册会员的人群特征，从而为不同客群指定个性化的会员服务</p>
</li>
<li>
<p>本次项目需要回答的问题： </p>
</li>
</ul>
<p>注册会员是否存在不同人群？
  不同人群的主要特征是什么？
  不同人群的人数占比是多少？销售贡献是多少？</p>
<ul>
<li>数据字典</li>
</ul>
<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td>CustomerID</td>
<td>用户ID</td>
<td>4</td>
</tr>
<tr>
<td>Gender</td>
<td>性别</td>
<td>Female</td>
</tr>
<tr>
<td>Age</td>
<td>年龄</td>
<td>23</td>
</tr>
<tr>
<td>Annual_Income (k$)</td>
<td>年收入</td>
<td>16</td>
</tr>
<tr>
<td>Spending_Score</td>
<td>消费指数（0-100）</td>
<td>77</td>
</tr>
<tr>
<td>visits_p12</td>
<td>过去12个月访问次数</td>
<td>44</td>
</tr>
<tr>
<td>morning_visits_p12</td>
<td>过去12个月早间访问次数</td>
<td>44</td>
</tr>
<tr>
<td>afternoon_visit_p12</td>
<td>过去12个月午间访问次数</td>
<td>0</td>
</tr>
<tr>
<td>evening_visits_p12</td>
<td>过去12个月晚间访问次数</td>
<td>0</td>
</tr>
<tr>
<td>morning_spending_score</td>
<td>早间消费指数</td>
<td>77</td>
</tr>
<tr>
<td>afternoon_spending_score</td>
<td>午间消费指数</td>
<td>0</td>
</tr>
<tr>
<td>evening_spending_score</td>
<td>晚间消费指数</td>
<td>0</td>
</tr>
<tr>
<td>weekday_visits_p12</td>
<td>过去12个月工作日访问次数</td>
<td>44</td>
</tr>
<tr>
<td>weekend_visits_p12</td>
<td>过去12个月周末访问次数</td>
<td>0</td>
</tr>
<tr>
<td>weekday_spending_score</td>
<td>工作日消费指数</td>
<td>77</td>
</tr>
<tr>
<td>weekend_spending_score</td>
<td>周末消费指数</td>
<td>0</td>
</tr>
<tr>
<td>fiirst_visit_till_today</td>
<td>注册历史长度（天）</td>
<td>269</td>
</tr>
<tr>
<td>with_kids_visits_p12</td>
<td>过去12个月带小孩次数</td>
<td>0</td>
</tr>
<tr>
<td>with_couple_visits_p12</td>
<td>过去12个月带伴侣次数</td>
<td>0</td>
</tr>
<tr>
<td>clothing_spending_score</td>
<td>服装类花费指数</td>
<td>0</td>
</tr>
<tr>
<td>food&amp;beverage_spending_score</td>
<td>饮食类花费指数</td>
<td>77</td>
</tr>
<tr>
<td>entertainment_spending_score</td>
<td>娱乐类花费指数</td>
<td>0</td>
</tr>
<tr>
<td>kids_spending_score</td>
<td>儿童类花费指数</td>
<td>0</td>
</tr>
</tbody>
</table>
<h3 id="41">4.1 数据加载<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<ul>
<li>导入数据</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/Mall_Customers.csv&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans1.png"/></p>
<ul>
<li>将文本型数据Gender替换为数值型变量，女性替换为1，男性替换为0</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># 为了方便后面计算, 将性别字段修改成 女性= 1  男性= 0</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Female&#39;</span><span class="p">,</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Male&#39;</span><span class="p">,</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans2.png"/></p>
<ul>
<li>先对性别，年龄，收入，消费评分聚类</li>
<li>截取对应字段，查看字段属性</li>
<li>一共有200条数据，</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">data_1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;CustomerID&#39;</span><span class="p">,</span> <span class="s1">&#39;Gender&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Annual_Income (k$)&#39;</span><span class="p">,</span> <span class="s1">&#39;Spending_Score&#39;</span><span class="p">]]</span>
<span class="n">data_1</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans3.png"/></p>
<ul>
<li>查看数据分布情况</li>
<li>年龄从18~70</li>
<li>年收入从1.5万到13.7万美元</li>
<li>消费评分从1到99</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">data_1</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans4.png"/></p>
<h3 id="42-eda_">4.2 EDA_单变量分析<a class="headerlink" href="#42-eda_" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>通过直方图了解数据分布情况</p>
</li>
<li>
<p>年龄分布，主要以青年和中年为主</p>
<div class="highlight"><pre><span></span><code><span class="c1"># pandas 绘图, 绘制直方图</span>
<span class="n">data_1</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;hist&#39;</span><span class="p">)</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans5.png"/></p>
</li>
<li>
<p>收入分布，大部分人集中在4~9万</p>
<div class="highlight"><pre><span></span><code><span class="c1"># pandas 绘图, 绘制直方图</span>
<span class="n">data_1</span><span class="p">[</span><span class="s1">&#39;Annual_Income (k$)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;hist&#39;</span><span class="p">)</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans6.png"/></p>
</li>
<li>
<p>消费能力评分,类似正态分布</p>
<div class="highlight"><pre><span></span><code><span class="c1"># pandas 绘图, 绘制直方图</span>
<span class="n">data_1</span><span class="p">[</span><span class="s1">&#39;Spending_Score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;hist&#39;</span><span class="p">)</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans7.png"/></p>
</li>
<li>
<p>KMeans建模之前，我们先进行归一化</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="c1">#创建归一化对象</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>

<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span> <span class="s2">&quot;scaled_Annual_Income (k$)&quot;</span><span class="p">,</span><span class="s1">&#39;Spending_Score&#39;</span><span class="p">]:</span>
    <span class="c1">#准备归一化之后的列名 在原有列名基础上添加&quot;scaled_&quot; 前缀</span>
    <span class="n">scaled_var</span> <span class="o">=</span> <span class="s2">&quot;scaled_&quot;</span> <span class="o">+</span> <span class="n">var</span>
    <span class="c1"># 调用MinMaxScaler 的fit方法, 找到每一列的最大值和最小值</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_1</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="c1"># transform 对每一列做归一化处理</span>
    <span class="n">data_1</span><span class="p">[</span><span class="n">scaled_var</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">data_1</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># 绘制归一化之后的结果(这里的绘图操作不是必须的,只是为了展示归一化不会改变每一列之间的数据相对关系)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">scaled_var</span><span class="p">)</span>
    <span class="n">data_1</span><span class="p">[</span><span class="n">scaled_var</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;hist&#39;</span><span class="p">)</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans8.png"/></p>
<h3 id="43-eda">4.3 EDA 多变量分析<a class="headerlink" href="#43-eda" title="Permanent link">&para;</a></h3>
<ul>
<li>通过seaborn绘制变量两两关系图</li>
<li>从图中看出使用收入和消费评分聚类效果会比较好</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;scaled_Age&quot;</span><span class="p">,</span><span class="s2">&quot;scaled_Annual_Income (k$)&quot;</span><span class="p">,</span> <span class="s2">&quot;scaled_Spending_Score&quot;</span><span class="p">]</span>
<span class="c1"># seaborn 绘制两两变量散点图</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data_1</span><span class="p">[</span><span class="n">columns</span><span class="p">])</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans9.png"/></p>
<ul>
<li>通过plotly绘制3D图，查看三个变量之间关系</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="c1"># plotly绘制3D散点图 传入数据, x, y,z轴数据, 指定width 图片宽度 height图片高度</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_3d</span><span class="p">(</span><span class="n">data_1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;scaled_Age&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;scaled_Annual_Income (k$)&#39;</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="s1">&#39;scaled_Spending_Score&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans10.png"/></p>
<ul>
<li>我们进一步加入一个维度，用颜色区分，分别查看4个变量之间的关系</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">variables_list</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span><span class="s1">&#39;scaled_Age&#39;</span><span class="p">,</span><span class="s1">&#39;scaled_Annual_Income (k$)&#39;</span><span class="p">,</span> <span class="s1">&#39;scaled_Spending_Score&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">variables_list</span><span class="p">)):</span>
    <span class="c1"># 指定绘图用到的数据列</span>
    <span class="n">axis_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span><span class="s1">&#39;scaled_Age&#39;</span><span class="p">,</span><span class="s1">&#39;scaled_Annual_Income (k$)&#39;</span><span class="p">,</span> <span class="s1">&#39;scaled_Spending_Score&#39;</span><span class="p">]</span>
    <span class="c1"># 找到用作区分颜色的列</span>
    <span class="n">legend</span> <span class="o">=</span> <span class="n">variables_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="c1"># 绘图数据去除掉用来做颜色区分的列, axis_list 去掉一个, 剩下的3个用来绘图, pop出去的用来做颜色区分</span>
    <span class="n">axis_list</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="c1"># 获取绘图的 x,y,z轴数据</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">axis_list</span>
    <span class="c1"># 绘制3d散点图</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_3d</span><span class="p">(</span><span class="n">data_1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">data_1</span><span class="p">[</span><span class="n">legend</span><span class="p">],</span><span class="n">width</span><span class="o">=</span><span class="mi">950</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">950</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p>性别作为颜色区分变量</p>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans11.png"/></p>
<p>年龄作为颜色区分变量</p>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans12.png"/></p>
<p>年收入作为颜色区分变量</p>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans13.png"/></p>
<p>消费评分作为颜色区分变量</p>
<p><img alt="" src="06-%E6%A1%88%E4%BE%8B-%E5%AE%8C%E6%95%B4%E9%A1%BE%E5%AE%A2%E6%95%B0%E6%8D%AE%E8%81%9A%E7%B1%BB%20.assets/kmeans37.png" /></p>
<h3 id="44-kmeans">4.4 KMeans聚类<a class="headerlink" href="#44-kmeans" title="Permanent link">&para;</a></h3>
<ul>
<li>我们分别尝试使用年龄，消费评分 以及 年收入和消费评分作为聚类特征进行聚类，并使用肘方法和轮廓系数作为评估指标</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">#年龄和消费评分</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">data_1</span><span class="p">[[</span><span class="s2">&quot;scaled_Age&quot;</span><span class="p">,</span> <span class="s2">&quot;scaled_Spending_Score&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="c1">#年收入和消费评分</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">data_1</span><span class="p">[[</span><span class="s2">&quot;scaled_Annual_Income (k$)&quot;</span><span class="p">,</span> <span class="s2">&quot;scaled_Spending_Score&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
</code></pre></div>
<ul>
<li>封装KMeans聚类方法，返回簇内误差平方和，标签，聚类中心点，轮廓系数</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>

<span class="k">def</span> <span class="nf">KMeans_Algorithm</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="c1"># 创建KMeans对象 n_clusters指定分群数量  max_iter 最大迭代次数</span>
    <span class="n">clustering_KMeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span> <span class="n">n</span><span class="p">,</span><span class="n">init</span><span class="o">=</span><span class="s1">&#39;k-means++&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># 传入数据, 计算分群结果</span>
    <span class="n">clustering_KMeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

    <span class="c1"># 保存聚类中心点</span>
    <span class="n">centroids</span>  <span class="o">=</span> <span class="n">clustering_KMeans</span><span class="o">.</span><span class="n">cluster_centers_</span>

    <span class="c1"># 为每个样本记录所属类别</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">clustering_KMeans</span><span class="o">.</span><span class="n">labels_</span>
    <span class="n">data_1</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>

    <span class="c1"># 计算簇内误差平方和</span>
    <span class="n">inertia</span> <span class="o">=</span> <span class="n">clustering_KMeans</span><span class="o">.</span><span class="n">inertia_</span>
    <span class="c1">#计算轮廓系数</span>
    <span class="n">silhouette_score</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">silhouette_score</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">inertia</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">silhouette_score</span>
</code></pre></div>
<ul>
<li>消费评分和年龄作为特征聚类</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">X1_inertia_values</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">X1_silhouette_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">fig1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span>
    <span class="c1"># 调用上面封装的方法, 进行KMeans分群</span>
    <span class="n">X1_inertia</span><span class="p">,</span> <span class="n">X1_label</span><span class="p">,</span> <span class="n">X1_centroids</span><span class="p">,</span> <span class="n">X1_silhouette</span> <span class="o">=</span> <span class="n">KMeans_Algorithm</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="c1"># 记录SSE的值</span>
    <span class="n">X1_inertia_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X1_inertia</span><span class="p">)</span>
    <span class="c1">#记录轮廓系数的计算结果</span>
    <span class="n">X1_silhouette_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X1_silhouette</span><span class="p">)</span>
    <span class="c1"># 保存聚类中心点, 创建DataFrame</span>
    <span class="n">centroids_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X1_centroids</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">])</span>

    <span class="c1"># 绘图,创建一个9个格子的画布 330代表3行3列   i-1 意味着从1到9 画9个格子</span>
    <span class="n">sub</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">330</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 上面方法返回的是一个axes对象, 我们在这个axes 对象里画散点图, 传入X, Y数据, s = 点的大小 c = 颜色</span>
    <span class="n">sub</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_1</span><span class="p">[</span><span class="s2">&quot;scaled_Age&quot;</span><span class="p">],</span> <span class="n">data_1</span><span class="p">[</span><span class="s2">&quot;scaled_Spending_Score&quot;</span><span class="p">],</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">data_1</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">],</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;RdBu&quot;</span><span class="p">)</span><span class="c1">#cmap 配色方案</span>
    <span class="c1"># marker= 配置点显示的形状  这里是一个方块 默认是圆形</span>
    <span class="n">sub</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">centroids_df</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">centroids_df</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="c1"># 设置X轴标签</span>
    <span class="n">sub</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Age&quot;</span><span class="p">)</span>
    <span class="c1"># 设置Y轴标签</span>
    <span class="n">sub</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Spending Score (1-100)&quot;</span><span class="p">)</span>


<span class="c1"># 肘方法找最佳聚类数</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span> <span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="c1"># np.arange(2,11) x轴坐标 从2到10   X1_inertia_values 不同聚类对应的SSE值</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span> <span class="p">,</span> <span class="n">X1_inertia_values</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Clusters&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Inertia Values&quot;</span><span class="p">)</span>

<span class="c1"># 轮廓系数</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="c1"># np.arange(2,11) x轴坐标 从2到10   X1_inertia_values 不同聚类对应轮廓系数的值</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">),</span> <span class="n">X1_silhouette_scores</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Clusters&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Silhouette Score&quot;</span><span class="p">)</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans15.png"/></p>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans16.png"/></p>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans17.png"/></p>
<ul>
<li>消费评分和年收入聚类</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># 消费评分 vs.年收入 </span>
<span class="n">X2_inertia_values</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">X2_silhouette_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">fig2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span>
    <span class="n">X2_inertia</span><span class="p">,</span> <span class="n">X2_label</span><span class="p">,</span> <span class="n">X2_centroids</span><span class="p">,</span> <span class="n">X2_silhouette</span>  <span class="o">=</span> <span class="n">KMeans_Algorithm</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">X2_inertia_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X2_inertia</span><span class="p">)</span>
    <span class="n">X2_silhouette_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X2_silhouette</span><span class="p">)</span>
    <span class="n">centroids_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X2_centroids</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">])</span>
    <span class="n">sub</span> <span class="o">=</span> <span class="n">fig2</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">330</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">sub</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_1</span><span class="p">[</span><span class="s2">&quot;scaled_Annual_Income (k$)&quot;</span><span class="p">],</span> <span class="n">data_1</span><span class="p">[</span><span class="s2">&quot;scaled_Spending_Score&quot;</span><span class="p">],</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">data_1</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">],</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;RdBu&quot;</span><span class="p">)</span>
    <span class="n">sub</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">centroids_df</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">centroids_df</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">sub</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Annual Income (k$)&quot;</span><span class="p">)</span>
    <span class="n">sub</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Spending Score (1-100)&quot;</span><span class="p">)</span>


<span class="c1"># 肘方法</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span> <span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span> <span class="p">,</span> <span class="n">X2_inertia_values</span> <span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Clusters&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Inertia Values&quot;</span><span class="p">)</span>

<span class="c1"># 肘方法对应的促内误差平方和</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span> <span class="p">,</span> <span class="n">X2_silhouette_scores</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Clusters&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Silhouette Score&quot;</span><span class="p">)</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans18.png"/></p>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans19.png"/></p>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans20.png"/></p>
<ul>
<li>使用年龄，消费评分和年收入三个变量进行分群</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># 经过上面的分析过程，基本可以清楚，分5群或者6群效果较好</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Spending_Score&#39;</span><span class="p">,</span> <span class="s1">&#39;Annual_Income (k$)&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="c1"># 创建KMeans对象分5群</span>
<span class="n">km</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span><span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1"># 传入数据计算聚类结果</span>
<span class="n">km</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># 保存聚类标签</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">km</span><span class="o">.</span><span class="n">labels_</span>
<span class="c1"># 保存聚类中心点</span>
<span class="n">centroids</span> <span class="o">=</span> <span class="n">km</span><span class="o">.</span><span class="n">cluster_centers_</span>
<span class="c1"># 把聚类标签保存到labels字段</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span>
<span class="c1"># 计算轮廓系数</span>
<span class="n">silhouette_score</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">silhouette_score</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="n">silhouette_score</span>
</code></pre></div>
<ul>
<li>plotly绘图</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_3d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Spending_Score&#39;</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="s1">&#39;Annual_Income (k$)&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;labels&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans21.png"/></p>
<ul>
<li>分6群</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Spending_Score&#39;</span><span class="p">,</span> <span class="s1">&#39;Annual_Income (k$)&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">km</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span><span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">km</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">km</span><span class="o">.</span><span class="n">labels_</span>
<span class="n">centroids</span> <span class="o">=</span> <span class="n">km</span><span class="o">.</span><span class="n">cluster_centers_</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span>
<span class="n">silhouette_score</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">silhouette_score</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="n">silhouette_score</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_3d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Spending_Score&#39;</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="s1">&#39;Annual_Income (k$)&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;labels&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans22.png"/></p>
<h3 id="45">4.5 结果解读<a class="headerlink" href="#45" title="Permanent link">&para;</a></h3>
<ul>
<li>我们按照分群标签进行分组，查看每组不同维度的数据分布情况</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;labels&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">Gender</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans23.png"/></p>
<ul>
<li>从上面结果中看出，大多数组别都是女性人数大于男性人数，只有2群男性多于女性</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;labels&#39;</span><span class="p">)[</span><span class="s2">&quot;Annual_Income (k$)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans24.png"/></p>
<ul>
<li>可以看出收入大概可以分成15~ 39、39~ 70、70~137 3组，0群和3群，1群和4群，2群和5群分别为低收入、中收入、高收入三组</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;labels&#39;</span><span class="p">)[</span><span class="s2">&quot;Spending_Score&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans25.png"/></p>
<ul>
<li>从上面结果看出，消费分数可以大致分为0~ 39，40~ 60，61~ 99三组，分别对应低消费，中消费，高消费三组</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;labels&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans30.png"/></p>
<ul>
<li>我们可以进一步按照其它维度进行查看</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;labels&#39;</span><span class="p">)[</span><span class="s2">&quot;kids_spending_score&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;labels&#39;</span><span class="p">)[</span><span class="s2">&quot;clothing_spending_score&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans26.png"/><img alt="" src="06-%E6%A1%88%E4%BE%8B-%E5%AE%8C%E6%95%B4%E9%A1%BE%E5%AE%A2%E6%95%B0%E6%8D%AE%E8%81%9A%E7%B1%BB%20.assets/kmeans27.png" /></p>
<div class="highlight"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;labels&#39;</span><span class="p">)[</span><span class="s2">&quot;food&amp;beverage_spending_score&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;labels&#39;</span><span class="p">)[</span><span class="s2">&quot;entertainment_spending_score&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans28.png"/><img alt="" src="06-%E6%A1%88%E4%BE%8B-%E5%AE%8C%E6%95%B4%E9%A1%BE%E5%AE%A2%E6%95%B0%E6%8D%AE%E8%81%9A%E7%B1%BB%20.assets/kmeans29.png" /></p>
<div class="highlight"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;labels&#39;</span><span class="p">)[</span><span class="s2">&quot;weekday_spending_score&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;labels&#39;</span><span class="p">)[</span><span class="s2">&quot;weekend_spending_score&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans31.png"/><img alt="" src="06-%E6%A1%88%E4%BE%8B-%E5%AE%8C%E6%95%B4%E9%A1%BE%E5%AE%A2%E6%95%B0%E6%8D%AE%E8%81%9A%E7%B1%BB%20.assets/kmeans32.png" /></p>
<div class="highlight"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;labels&#39;</span><span class="p">)[</span><span class="s2">&quot;with_kids_visits_p12&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;labels&#39;</span><span class="p">)[</span><span class="s2">&quot;with_couple_visits_p12&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div>
<p><img src="C:/Users/uncle/Desktop/机器学习课件/聚类算法/img/kmeans33.png"/><img alt="" src="06-%E6%A1%88%E4%BE%8B-%E5%AE%8C%E6%95%B4%E9%A1%BE%E5%AE%A2%E6%95%B0%E6%8D%AE%E8%81%9A%E7%B1%BB%20.assets/kmeans34.png" /></p>
<ul>
<li>从上面结果中看出</li>
<li>0群收入较低，消费评分也较低，年龄分布从19到67，消费主要以餐饮和服饰为主</li>
<li>2群收入较高，男性为主，年龄从19到59，属于高收入低消费人群，大概是工作较忙，线下消费场景不多</li>
<li>1群和4群，收入中等，消费评分中等，消费主要以餐饮和服饰为主，1群比较年轻，4群年龄偏大</li>
<li>3群年龄比较年轻，18到35岁，收入属于低收入人群，但消费较高，从消费习惯上看，属于单身贵族，餐饮娱乐服饰消费都比较高。</li>
<li>
<p>5群年龄处于职场黄金年龄27到40岁，收入较高，消费也较高，这一组人群是重点关注人群，消费的时间主要是在周末，各个维度消费都较高，</p>
</li>
<li>
<p>加入周中周末的维度，最佳组数可能会变</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">CustomerGroupKmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span><span class="s1">&#39;Annual_Income (k$)&#39;</span><span class="p">,</span><span class="s1">&#39;Spending_Score&#39;</span><span class="p">,</span><span class="s1">&#39;weekday_visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;weekend_visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;weekday_spending_score&#39;</span><span class="p">,</span><span class="s1">&#39;weekend_spending_score&#39;</span><span class="p">]])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">CustomerGroupKmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span><span class="s1">&#39;Annual_Income (k$)&#39;</span><span class="p">,</span><span class="s1">&#39;Spending_Score&#39;</span><span class="p">,</span><span class="s1">&#39;weekday_visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;weekend_visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;weekday_spending_score&#39;</span><span class="p">,</span><span class="s1">&#39;weekend_spending_score&#39;</span><span class="p">])</span>
</code></pre></div>
<p><img alt="" src="06-%E6%A1%88%E4%BE%8B-%E5%AE%8C%E6%95%B4%E9%A1%BE%E5%AE%A2%E6%95%B0%E6%8D%AE%E8%81%9A%E7%B1%BB%20.assets/kmeans35.png" /></p>
<ul>
<li>继续加入是否带小孩，陪伴侣，各项花费细分等</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">CustomerGroupKmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span><span class="s1">&#39;Annual_Income (k$)&#39;</span><span class="p">,</span><span class="s1">&#39;Spending_Score&#39;</span><span class="p">,</span><span class="s1">&#39;weekday_visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;weekend_visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;weekday_spending_score&#39;</span><span class="p">,</span><span class="s1">&#39;weekend_spending_score&#39;</span><span class="p">,</span><span class="s1">&#39;with_kids_visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;with_couple_visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;clothing_spending_score&#39;</span><span class="p">,</span><span class="s1">&#39;food&amp;beverage_spending_score&#39;</span><span class="p">,</span><span class="s1">&#39;entertainment_spending_score&#39;</span><span class="p">,</span><span class="s1">&#39;kids_spending_score&#39;</span><span class="p">]])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">CustomerGroupKmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span><span class="s1">&#39;Annual_Income (k$)&#39;</span><span class="p">,</span><span class="s1">&#39;Spending_Score&#39;</span><span class="p">,</span><span class="s1">&#39;weekday_visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;weekend_visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;weekday_spending_score&#39;</span><span class="p">,</span><span class="s1">&#39;weekend_spending_score&#39;</span><span class="p">,</span><span class="s1">&#39;with_kids_visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;with_couple_visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;clothing_spending_score&#39;</span><span class="p">,</span><span class="s1">&#39;food&amp;beverage_spending_score&#39;</span><span class="p">,</span><span class="s1">&#39;entertainment_spending_score&#39;</span><span class="p">,</span><span class="s1">&#39;kids_spending_score&#39;</span><span class="p">])</span>
</code></pre></div>
<p><img alt="" src="06-%E6%A1%88%E4%BE%8B-%E5%AE%8C%E6%95%B4%E9%A1%BE%E5%AE%A2%E6%95%B0%E6%8D%AE%E8%81%9A%E7%B1%BB%20.assets/kmeans36.png" /></p>
<ul>
<li>我们可以把结果保存起来，方便交付给运营人员</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Kmeans_result&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">CustomerGroupKmeans</span><span class="o">.</span><span class="n">labels_</span>
<span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;CustomerGroup_k_means_result.csv&quot;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">CustomerGroupKmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span><span class="s1">&#39;Annual_Income (k$)&#39;</span><span class="p">,</span><span class="s1">&#39;Spending_Score&#39;</span><span class="p">,</span><span class="s1">&#39;weekday_visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;weekend_visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;weekday_spending_score&#39;</span><span class="p">,</span><span class="s1">&#39;weekend_spending_score&#39;</span><span class="p">,</span><span class="s1">&#39;with_kids_visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;with_couple_visits_p12&#39;</span><span class="p">,</span><span class="s1">&#39;clothing_spending_score&#39;</span><span class="p">,</span><span class="s1">&#39;food&amp;beverage_spending_score&#39;</span><span class="p">,</span><span class="s1">&#39;entertainment_spending_score&#39;</span><span class="p">,</span><span class="s1">&#39;kids_spending_score&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;label_centers.csv&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="45_1">4.5 总结<a class="headerlink" href="#45_1" title="Permanent link">&para;</a></h3>
<ul>
<li>聚类算法无需标签，因此适合新数据的探索和数据挖掘</li>
<li>K means算法在实际使用过程中由于需要指定不同组数，因此需要多次尝试</li>
<li>对于聚类需要用到的各种特征需要有甄选和抽取的过程</li>
<li>最终通过多次解读不同尝试下的聚类结果，才能沉淀一些有用的知识</li>
</ul>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "search": "../assets/javascripts/workers/search.092fa1f6.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.5a9542cf.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../js/extra.js"></script>
      
    
  </body>
</html>