
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../img/logo.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.11">
    
    
      
        <title>案例1：简单线性回归 - 机器学习讲义</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50e68009.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../index.html" title="机器学习讲义" class="md-header__button md-logo" aria-label="机器学习讲义" data-md-component="logo">
      
  <img src="../img/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            机器学习讲义
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              案例1：简单线性回归
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="清空当前内容" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
    <img src="../assets/images/logo.svg" height="45px" alt="logo">

  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="机器学习讲义" class="md-nav__button md-logo" aria-label="机器学习讲义" data-md-component="logo">
      
  <img src="../img/logo.png" alt="logo">

    </a>
    机器学习讲义
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          1、机器学习概述
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="1、机器学习概述" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          1、机器学习概述
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01-%E5%89%8D%E7%BD%AE%E6%A6%82%E5%BF%B5/00-README.html" class="md-nav__link">
        01_内容介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01-%E5%89%8D%E7%BD%AE%E6%A6%82%E5%BF%B5/01-%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E6%A6%82%E5%BF%B5.html" class="md-nav__link">
        02_人工智能概念
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01-%E5%89%8D%E7%BD%AE%E6%A6%82%E5%BF%B5/02-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%A6%82%E5%BF%B5.html" class="md-nav__link">
        03_机器学习概念
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01-%E5%89%8D%E7%BD%AE%E6%A6%82%E5%BF%B5/03-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%88%86%E7%B1%BB.html" class="md-nav__link">
        04_机器学习分类
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01-%E5%89%8D%E7%BD%AE%E6%A6%82%E5%BF%B5/05-%E6%8B%9F%E5%90%88%E9%97%AE%E9%A2%98.html" class="md-nav__link">
        05_拟合问题
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01-%E5%89%8D%E7%BD%AE%E6%A6%82%E5%BF%B5/06-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%99%A8%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html" class="md-nav__link">
        06_机器学习开发环境
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          2、K近邻
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="2、K近邻" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          2、K近邻
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02-K%E8%BF%91%E9%82%BB/00-README.html" class="md-nav__link">
        01_内容介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02-K%E8%BF%91%E9%82%BB/01-K%E8%BF%91%E9%82%BB%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86.html" class="md-nav__link">
        02_K近邻算法原理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02-K%E8%BF%91%E9%82%BB/02-%E8%B7%9D%E7%A6%BB%E7%9A%84%E5%BA%A6%E9%87%8F%E6%96%B9%E6%B3%95.html" class="md-nav__link">
        03_距离的度量方法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02-K%E8%BF%91%E9%82%BB/03-%E5%BD%92%E4%B8%80%E5%8C%96%E5%92%8C%E6%A0%87%E5%87%86%E5%8C%96.html" class="md-nav__link">
        04_归一化和标准化
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02-K%E8%BF%91%E9%82%BB/04-K%E8%BF%91%E9%82%BB%E7%AE%97%E6%B3%95API.html" class="md-nav__link">
        05_K近邻算法API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02-K%E8%BF%91%E9%82%BB/06-%E5%88%86%E7%B1%BB%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E6%96%B9%E6%B3%95.html" class="md-nav__link">
        06_分类模型评估方法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02-K%E8%BF%91%E9%82%BB/05-K%E5%80%BC%E9%80%89%E6%8B%A9%E9%97%AE%E9%A2%98.html" class="md-nav__link">
        07_K值选择问题
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02-K%E8%BF%91%E9%82%BB/07-%E6%A1%88%E4%BE%8B-%E6%89%8B%E5%86%99%E6%95%B0%E5%AD%97%E8%AF%86%E5%88%AB.html" class="md-nav__link">
        08_案例-手写数字识别
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          3、线性回归
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="3、线性回归" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          3、线性回归
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="00-README.html" class="md-nav__link">
        01_内容介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="01-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E5%8E%9F%E7%90%86.html" class="md-nav__link">
        02_线性回归原理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="03-%E6%AD%A3%E8%A7%84%E6%96%B9%E7%A8%8B.html" class="md-nav__link">
        03_损失函数和正规方程
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="%E6%B1%82%E5%AF%BC.html" class="md-nav__link">
        04_求导
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="04-%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%952.html" class="md-nav__link">
        05_梯度下降法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="05-%E5%85%B6%E4%BB%96%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%96%B9%E6%B3%95.html" class="md-nav__link">
        06_其他梯度下降方法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="%E5%9B%9E%E5%BD%92%E9%97%AE%E9%A2%98%E8%AF%84%E4%BC%B0.html" class="md-nav__link">
        07_回归问题评估
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="06-%E6%AD%A3%E5%88%99%E5%8C%96.html" class="md-nav__link">
        08_过拟合欠拟合与正则化
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="07-%E6%A1%88%E4%BE%8B-%E6%B3%A2%E5%A3%AB%E9%A1%BF%E6%94%BE%E4%BB%B7%E9%A2%84%E6%B5%8B.html" class="md-nav__link">
        09_案例-波士顿房价预测
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          4、逻辑回归
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="4、逻辑回归" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          4、逻辑回归
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/00-README.html" class="md-nav__link">
        01_内容介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/01-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E7%AE%80%E4%BB%8B.html" class="md-nav__link">
        02_逻辑回归介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/03-%E6%A1%88%E4%BE%8B-%E7%99%8C%E7%97%87%E5%88%86%E7%B1%BB%E9%A2%84%E6%B5%8B.html" class="md-nav__link">
        03_案例-癌症分类预测
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/04-%E5%88%86%E7%B1%BB%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87.html" class="md-nav__link">
        04_分类评估指标
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/06-%E7%BB%83%E4%B9%A0-%E7%94%B5%E4%BF%A1%E5%AE%A2%E6%88%B7%E6%B5%81%E5%A4%B1.html" class="md-nav__link">
        05_案例-电信客户流失
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          5、决策树
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="5、决策树" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          5、决策树
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E5%86%B3%E7%AD%96%E6%A0%91/00-README.html" class="md-nav__link">
        01_内容介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E5%86%B3%E7%AD%96%E6%A0%91/01-%E5%86%B3%E7%AD%96%E6%A0%91%E4%BB%8B%E7%BB%8D.html" class="md-nav__link">
        02_决策树介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E5%86%B3%E7%AD%96%E6%A0%91/03-ID3%E5%86%B3%E7%AD%96%E6%A0%91.html" class="md-nav__link">
        03_ID3决策树
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E5%86%B3%E7%AD%96%E6%A0%91/04-C4.5%E5%86%B3%E7%AD%96%E6%A0%91.html" class="md-nav__link">
        04_C4.5决策树
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E5%86%B3%E7%AD%96%E6%A0%91/05-CART%E5%86%B3%E7%AD%96%E6%A0%91.html" class="md-nav__link">
        05_CART决策树
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E5%86%B3%E7%AD%96%E6%A0%91/06-%E5%9B%9E%E5%BD%92%E5%86%B3%E7%AD%96%E6%A0%91.html" class="md-nav__link">
        06_回归决策树
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E5%86%B3%E7%AD%96%E6%A0%91/07-%E5%89%AA%E6%9E%9D.html" class="md-nav__link">
        07_剪枝
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E5%86%B3%E7%AD%96%E6%A0%91/08-%E6%A1%88%E4%BE%8B-%E6%B3%B0%E5%9D%A6%E5%B0%BC%E5%85%8B%E5%8F%B7%E7%94%9F%E5%AD%98%E9%A2%84%E6%B5%8B.html" class="md-nav__link">
        08_案例-泰坦尼克号生存预测
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          6、朴素贝叶斯
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="6、朴素贝叶斯" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          6、朴素贝叶斯
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06-%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF/00-README.html" class="md-nav__link">
        01_内容介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06-%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF/01-%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%8E%9F%E7%90%86.html" class="md-nav__link">
        02_朴素贝叶斯原理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06-%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF/02-%E6%A1%88%E4%BE%8B-%E5%95%86%E5%93%81%E8%AF%84%E8%AE%BA%E5%88%86%E7%B1%BB.html" class="md-nav__link">
        03_案例-垃圾邮件分类
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          7、支持向量机
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="7、支持向量机" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          7、支持向量机
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../07-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/00-README.html" class="md-nav__link">
        01_内容介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../07-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/01-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E5%BC%95%E5%85%A5.html" class="md-nav__link">
        02_支持向量引入
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../07-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/02-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%A6%82%E5%BF%B5.html" class="md-nav__link">
        03_支持向量概念
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../07-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/04-%E6%A0%B8%E6%96%B9%E6%B3%95.html" class="md-nav__link">
        04_核方法和损失函数
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../07-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/06-%E6%A1%88%E4%BE%8B-%E9%B8%A2%E5%B0%BE%E8%8A%B1%E7%A7%8D%E7%B1%BB%E9%A2%84%E6%B5%8B.html" class="md-nav__link">
        05_案例-鸢尾花种类预测
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          8、聚类算法
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="8、聚类算法" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          8、聚类算法
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../08-%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95/00-README.html" class="md-nav__link">
        01_内容介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../08-%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95/section1.html" class="md-nav__link">
        02_聚类概述
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../08-%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95/section2.html" class="md-nav__link">
        03_KMeans API介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../08-%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95/section3.html" class="md-nav__link">
        04_KMeans实现流程
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../08-%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95/section4.html" class="md-nav__link">
        04_聚类效果评估
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../08-%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95/04-%E7%89%B9%E5%BE%81%E9%99%8D%E7%BB%B4.html" class="md-nav__link">
        05_特征降维
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../08-%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95/section5.html" class="md-nav__link">
        06_案例-顾客数据聚类分析
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          9、集成学习
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="9、集成学习" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          9、集成学习
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/00-README.html" class="md-nav__link">
        01_内容介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/01-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0%E9%97%AE%E9%A2%98.html" class="md-nav__link">
        02_集成学习问题
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/02-Bagging%E5%92%8C%E9%9A%8F%E6%9C%BA%E6%A3%AE%E6%9E%97.html" class="md-nav__link">
        03_Bagging和随机森林
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/03-Boosting%E5%92%8CAdaBoost.html" class="md-nav__link">
        04_Boosting和AdaBoost
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/04-%E6%A1%88%E4%BE%8B-%E8%BD%A6%E8%BE%86%E8%B4%B7%E6%AC%BE%E8%BF%9D%E7%BA%A6%E9%A2%84%E6%B5%8B.html" class="md-nav__link">
        05_案例-车辆贷款违约预测
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/05-GBDT.html" class="md-nav__link">
        06_GBDT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/06-XGBoost_1.html" class="md-nav__link">
        07_XGBoost
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/07-%E6%A1%88%E4%BE%8B-%E7%BA%A2%E9%85%92%E5%93%81%E8%B4%A8%E5%88%86%E7%B1%BB.html" class="md-nav__link">
        08_案例-红酒品质分类
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    1. 数据集介绍
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. 拟合最佳直线
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3. 计算
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="1">案例1：简单线性回归<a class="headerlink" href="#1" title="Permanent link">&para;</a></h1>
<hr />
<h2 id="1_1">1. 数据集介绍<a class="headerlink" href="#1_1" title="Permanent link">&para;</a></h2>
<ul>
<li>需求：寻找汽车销售数随着电视广告数的关系</li>
</ul>
<p>汽车卖家做电视广告数量与卖出的汽车数量：</p>
<table>
<thead>
<tr>
<th>电视广告数（x）</th>
<th>汽车销售数（y）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>14</td>
</tr>
<tr>
<td>3</td>
<td>24</td>
</tr>
<tr>
<td>2</td>
<td>18</td>
</tr>
<tr>
<td>1</td>
<td>17</td>
</tr>
<tr>
<td>3</td>
<td>27</td>
</tr>
<tr>
<td>Sum（x）=10，Avg（x）=2</td>
<td>Sum（y）=100，Avg（y）=20</td>
</tr>
</tbody>
</table>
<h2 id="2">2. 拟合最佳直线<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<ul>
<li>如何找出适合简单线性回归模型的最佳回归线？</li>
</ul>
<p><img alt="img" src="06-%E7%BB%83%E4%B9%A0.assets/wps366A.tmp.jpg" /> </p>
<p>这里我们通过构造以下函数并使得该函数最小来求解最佳拟合的直线</p>
<p><img alt="img" src="06-%E7%BB%83%E4%B9%A0.assets/wps366B.tmp.png" /></p>
<p>如下图所示：</p>
<p><img alt="img" src="06-%E7%BB%83%E4%B9%A0.assets/wps366C.tmp.jpg" /> </p>
<p>如果使得上述函数最小，这里我们借助我们高中学习的导数方法，先求导并令导数为0来求解最佳的拟合直线的参数，如一次项的系数和常数项的值。</p>
<p>这里避免过于复杂的数学推导，直接给出一次项系数的参数<img alt="img" src="06-%E7%BB%83%E4%B9%A0.assets/wps367D.tmp.png" />和偏差项<img alt="img" src="06-%E7%BB%83%E4%B9%A0.assets/wps367E.tmp.png" /></p>
<p><img alt="img" src="06-%E7%BB%83%E4%B9%A0.assets/wps367F.tmp.png" />，<img alt="img" src="06-%E7%BB%83%E4%B9%A0.assets/wps3680.tmp.png" /></p>
<h2 id="3">3. 计算<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<p>如下表：</p>
<table>
<thead>
<tr>
<th>电视广告数（x）</th>
<th>汽车销售数（y）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>14</td>
</tr>
<tr>
<td>3</td>
<td>24</td>
</tr>
<tr>
<td>2</td>
<td>18</td>
</tr>
<tr>
<td>1</td>
<td>17</td>
</tr>
<tr>
<td>3</td>
<td>27</td>
</tr>
<tr>
<td>Sum（x）=10，Avg（x）=2</td>
<td>Sum（y）=100，Avg（y）=20</td>
</tr>
</tbody>
</table>
<p>分子 = (1-2)(14-20)+(3-2)(24-20)+(2-2)(18-20)+(1-2)(17-20)+(3-2)(27-20)</p>
<p>= 6 + 4 + 0 + 3 + 7</p>
<p>= 20</p>
<p>分母 = （1-2）^2 + (3-2)^2 + (2-2)^2 + (1-2)^2 + (3-2)^2</p>
<p>​    = 1 + 1 + 0 + 1 + 1</p>
<p>​    4</p>
<p>b1 = 20/4  =5</p>
<p>b0=20-5*2=10</p>
<p>假设有一周广告数量为6，预测的汽车销售量是多少？</p>
<p><img alt="img" src="06-%E7%BB%83%E4%B9%A0.assets/wpsC4F.tmp.jpg" /> </p>
<p>x_given = 6</p>
<p>Y_hat = 5*6 + 10 = 40</p>
<h1 id="2_1">案例2：多元线性回归<a class="headerlink" href="#2_1" title="Permanent link">&para;</a></h1>
<h2 id="1_2">1. 数据集介绍<a class="headerlink" href="#1_2" title="Permanent link">&para;</a></h2>
<p>一家快递公司送货：X1： 运输里程 X2： 运输次数  Y：总运输时间，求解Y关于X1和X2的拟合方程及曲线。</p>
<p><img alt="image-20220118150522245" src="06-%E7%BB%83%E4%B9%A0.assets/image-20220118150522245.png" /></p>
<h2 id="2_2">2.拟合最佳直线<a class="headerlink" href="#2_2" title="Permanent link">&para;</a></h2>
<p>设立回归方程：Y(Time) = b0+ b1*Miles + b2 * Deliveries </p>
<p>按照最小二乘法，计算得到b0，b1，b2以及最终的结果如下： </p>
<p>Time = -0.869 + 0.0611 Miles + 0.923 Deliveries </p>
<p>描述参数含义</p>
<ul>
<li>
<p>b1: 平均每多运送一英里，运输时间延长0.0611 小时</p>
</li>
<li>
<p>b2: 平均每多一次运输，运输时间延长 0.923 小时</p>
</li>
</ul>
<h2 id="3_1">3.预测<a class="headerlink" href="#3_1" title="Permanent link">&para;</a></h2>
<p>如果一个运输任务是跑102英里，运输6次，预计多少小时？</p>
<p>Time = -0.869 +0.0611 *102+ 0.923 * 6= 10.9 (小时）</p>
<h2 id="4">4.代码实现<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<p>数据：</p>
<p>1.在execl中输入数据另存为csv文件</p>
<p>2.直接在txt中输入数据以逗号隔开</p>
<p><img alt="img" src="06-%E7%BB%83%E4%B9%A0.assets/wps27CF.tmp.jpg" /> </p>
<ul>
<li>代码</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">#-*-coding:utf8-*-</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">genfromtxt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span><span class="p">,</span><span class="n">linear_model</span>
<span class="c1">#组织数据，通过逗号分隔的CSV文件组织</span>
<span class="n">datapath</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;D:\delivery.csv&quot;</span>
<span class="n">delivesyData</span><span class="o">=</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">datapath</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;data&quot;</span><span class="p">,</span><span class="n">delivesyData</span>
<span class="c1">#区分特征和类标签</span>
<span class="n">X</span><span class="o">=</span><span class="n">delivesyData</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Y</span><span class="o">=</span><span class="n">delivesyData</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="c1">#打印切分的数据</span>
<span class="nb">print</span> <span class="s2">&quot;X&quot;</span><span class="p">,</span><span class="n">X</span>
<span class="nb">print</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span><span class="n">Y</span>
<span class="c1">#模型初始化</span>
<span class="n">regr</span><span class="o">=</span><span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="c1">#打印模型的属性</span>
<span class="nb">print</span> <span class="s2">&quot;coefficient&quot;</span><span class="p">,</span><span class="n">regr</span><span class="o">.</span><span class="n">coef_</span>
<span class="nb">print</span> <span class="s2">&quot;intercept&quot;</span><span class="p">,</span><span class="n">regr</span><span class="o">.</span><span class="n">intercept_</span>
<span class="c1">#适用模型进行预测</span>
<span class="n">xPred</span><span class="o">=</span><span class="p">[</span><span class="mi">102</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="n">yPred</span><span class="o">=</span><span class="n">regr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xPred</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;Y-predicted&quot;</span><span class="p">,</span><span class="n">yPred</span>
</code></pre></div>
<h1 id="3_2">案例3：销售额回归分析<a class="headerlink" href="#3_2" title="Permanent link">&para;</a></h1>
<h2 id="1_3">1.销售额预测分析背景介绍<a class="headerlink" href="#1_3" title="Permanent link">&para;</a></h2>
<p>快消企业，分析目的</p>
<p>- 对商超门店的销售额进行预测</p>
<p>- 量化自身所能控制的各种促销因素所能产生的效果</p>
<p>- 对营销资源做出合理规划</p>
<p>传统快消企业，数据特点</p>
<p>- 聚合类的数据</p>
<p>- 渠道众多，无法精准了解用户</p>
<p>本例中，通过回归分析实现对各类因素投入产出比做出评估</p>
<p>- 分析数据</p>
<p>- 电视广告，线上，线下，门店内，微信渠道等促销投入和销售额之间的关系</p>
<p>- 数据说明 （以月为观测窗口）</p>
<p>- Revenue 门店销售额</p>
<p>- Reach 微信广告次数</p>
<p>- Local_tv  本地电视广告投入</p>
<p>- Online  线上广告投入</p>
<p>- Instore 门店内海报等投入</p>
<p>- Person 门店促销人员</p>
<p>- Event 促销事件 </p>
<p>- cobranding 品牌联合促销 </p>
<p>- holiday 节假日 </p>
<p>- special 门店特别促销 </p>
<p>- non-event 无促销活动</p>
<h2 id="2_3">2.分析流程<a class="headerlink" href="#2_3" title="Permanent link">&para;</a></h2>
<p>数据概况分析-&gt;单变量分析-&gt;相关性分析与可视化-&gt;回归模型</p>
<p>- 数据概况分析</p>
<p>- 数据行/列数量</p>
<p>- 缺失值分布</p>
<p>- 单变量分析</p>
<p>- 数字型变量的描述指标（平均值，最大最小值，标准差）</p>
<p>- 类别型变量（多少个分类，各自占比）</p>
<p>- 相关性分析与可视化</p>
<p>- 按类别交叉对比</p>
<p>- 变量之间的相关性分析</p>
<p>- 散点图/热力图</p>
<p>- 回归分析</p>
<p>- 模型建立</p>
<p>- 模型评估与优化</p>
<h2 id="3_3">3.代码<a class="headerlink" href="#3_3" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>import pandas as pd
#数据读取#
#index_col=0 ，数据的第一列是索引，指定索引列
store=pd.read_csv(&#39;store_rev.csv&#39;,index_col=0)
</code></pre></div>
<p>如下截图：</p>
<p><img alt="img" src="06-%E7%BB%83%E4%B9%A0.assets/wpsC7C4.tmp.jpg" /> </p>
<div class="highlight"><pre><span></span><code>#数据的基本信息
#发现local_tv有50多个空值
#发现event是object,即类别型变量
store.info()
</code></pre></div>
<p>如下图：</p>
<p><img alt="img" src="06-%E7%BB%83%E4%B9%A0.assets/wpsC7C5.tmp.jpg" /> </p>
<div class="highlight"><pre><span></span><code>#统计各个列哪些是空值
#发现local_tv有56个空值
store.isnull().sum()
&#39;&#39;&#39;
revenue      0
reach        0
local_tv    56
online       0
instore      0
person       0
event        0
dtype: int64
&#39;&#39;&#39;
#了解数据的分布
#判断数据是否符合业务场景
store.describe()
</code></pre></div>
<p>如下截图：</p>
<p><img alt="img" src="06-%E7%BB%83%E4%B9%A0.assets/wpsC7C6.tmp.jpg" /> </p>
<div class="highlight"><pre><span></span><code>#了解event的具体值
store.event.unique()
#array([&#39;non_event&#39;, &#39;special&#39;, &#39;cobranding&#39;, &#39;holiday&#39;], dtype=object)
#这些类别对应的revenue(销售额)是怎样的
store.groupby([&#39;event&#39;])[&#39;revenue&#39;].describe()
</code></pre></div>
<p>如下图：</p>
<p><img alt="img" src="06-%E7%BB%83%E4%B9%A0.assets/wpsC7C7.tmp.jpg" /> </p>
<div class="highlight"><pre><span></span><code>#这几个类别对应的local_tv（本地电视广告投入）是怎样的
store.groupby([&#39;event&#39;])[&#39;local_tv&#39;].describe()
</code></pre></div>
<p>如下图：</p>
<p><img alt="img" src="06-%E7%BB%83%E4%B9%A0.assets/wpsC7C8.tmp.jpg" /> </p>
<div class="highlight"><pre><span></span><code>#将类别变量转化为哑变量
store=pd.get_dummies(store)
#生成event的4个标签，每个标签取值0/1
store.head(10)
</code></pre></div>
<p>如下截图：</p>
<p><img alt="img" src="06-%E7%BB%83%E4%B9%A0.assets/wpsC7C9.tmp.jpg" /> </p>
<p>代码：</p>
<div class="highlight"><pre><span></span><code>#确认类别变量已经转换成数字变量
store.info()

&#39;&#39;&#39;
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 985 entries, 845 to 26
Data columns (total 10 columns):
revenue             985 non-null float64
reach               985 non-null int64
local_tv            929 non-null float64
online              985 non-null int64
instore             985 non-null int64
person              985 non-null int64
event_cobranding    985 non-null uint8
event_holiday       985 non-null uint8
event_non_event     985 non-null uint8
event_special       985 non-null uint8
dtypes: float64(2), int64(4), uint8(4)
memory usage: 57.7 KB
&#39;&#39;&#39;
</code></pre></div>
<p>相关性分析：</p>
<div class="highlight"><pre><span></span><code>#所有变量，任意两个变量相关分析
#local_tv,person,instore是比较好的指标，与revenue相关度高
store.corr()
</code></pre></div>
<p>如下截图：</p>
<p><img alt="img" src="06-%E7%BB%83%E4%B9%A0.assets/wpsC7CA.tmp.jpg" /> </p>
<div class="highlight"><pre><span></span><code>#其他变量与revenue的相关分析
#sort_values 将revenue排序，ascending默认升序，False为降序排列
#看到前3个相关变量为local_tv,person,instore
store.corr()[[&#39;revenue&#39;]].sort_values(&#39;revenue&#39;,ascending=False)
&#39;&#39;&#39;
                   revenue
revenue            1.000000
local_tv           0.602114
person             0.559208
instore            0.311739
online              0.171227
event_special       0.033752
event_cobranding    -0.005623
event_holiday       -0.016559
event_non_event     -0.019155
reach               -0.155314
&#39;&#39;&#39;
</code></pre></div>
<p>可视化分析</p>
<div class="highlight"><pre><span></span><code>#可视化分析
import seaborn as sns
import matplotlib.pyplot as plt
%matplotlib inline
#线性关系可视化
#斜率与相关系数有关
sns.regplot(&#39;local_tv&#39;,&#39;revenue&#39;,store)
</code></pre></div>
<p>如下图：</p>
<p><img alt="img" src="06-%E7%BB%83%E4%B9%A0.assets/wpsC7DA.tmp.jpg" /> </p>
<div class="highlight"><pre><span></span><code>#线性关系可视化
sns.regplot(&#39;person&#39;,&#39;revenue&#39;,store)
</code></pre></div>
<p>如下图：</p>
<p><img alt="img" src="06-%E7%BB%83%E4%B9%A0.assets/wpsC7DB.tmp.jpg" /> </p>
<div class="highlight"><pre><span></span><code>sns.regplot(&#39;instore&#39;,&#39;revenue&#39;,store)
</code></pre></div>
<p><img alt="img" src="06-%E7%BB%83%E4%B9%A0.assets/wpsC7DC.tmp.jpg" /> </p>
<p>线性回归分析</p>
<div class="highlight"><pre><span></span><code>from sklearn.linear_model import LinearRegression
model=LinearRegression()
store.dropna(inplace=True)
from sklearn.preprocessing import MinMaxScaler
scaler = MinMaxScaler()
#设定自变量和因变量
y=store[&#39;revenue&#39;]
#第一次三个 
x=store[[&#39;local_tv&#39;,&#39;person&#39;,&#39;instore&#39;]]
#第二次四个 
#x=store[[&#39;local_tv&#39;,&#39;person&#39;,&#39;instore&#39;,&#39;online&#39;]]
x1 = scaler.fit_transform(x)
model.fit(x1,y)
</code></pre></div>
<p>数据有缺失，不处理会报错，需要处理缺失值</p>
<div class="highlight"><pre><span></span><code><span class="c1">#缺失值处理,填充0</span>
<span class="n">store</span><span class="o">=</span><span class="n">store</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="c1">#缺失值处理,均值填充</span>
<span class="n">store</span><span class="o">=</span><span class="n">store</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">store</span><span class="o">.</span><span class="n">local_tv</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="n">store</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span>
<span class="sd">Int64Index: 985 entries, 845 to 26</span>
<span class="sd">Data columns (total 10 columns):</span>
<span class="sd">revenue             985 non-null float64</span>
<span class="sd">reach               985 non-null int64</span>
<span class="sd">local_tv            985 non-null float64</span>
<span class="sd">online              985 non-null int64</span>
<span class="sd">instore             985 non-null int64</span>
<span class="sd">person              985 non-null int64</span>
<span class="sd">event_cobranding    985 non-null uint8</span>
<span class="sd">event_holiday       985 non-null uint8</span>
<span class="sd">event_non_event     985 non-null uint8</span>
<span class="sd">event_special       985 non-null uint8</span>
<span class="sd">dtypes: float64(2), int64(4), uint8(4)</span>
<span class="sd">memory usage: 57.7 KB</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="c1">#自变量系数</span>
<span class="n">model</span><span class="o">.</span><span class="n">coef_</span>
<span class="c1">#模型的截距</span>
<span class="n">model</span><span class="o">.</span><span class="n">intercept_</span>
<span class="c1">#模型的评估,x为&#39;local_tv&#39;,&#39;person&#39;,&#39;instore&#39;</span>
<span class="n">score</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="c1">#x和y打分</span>
<span class="n">predictions</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="c1">#计算y预测值</span>
<span class="n">error</span><span class="o">=</span><span class="n">predictions</span><span class="o">-</span><span class="n">y</span><span class="c1">#计算误差</span>

<span class="n">rmse</span><span class="o">=</span><span class="p">(</span><span class="n">error</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">**</span><span class="mf">.5</span><span class="c1">#计算rmse</span>
<span class="n">mae</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="c1">#计算mae</span>

<span class="nb">print</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</code></pre></div>
<h3 id="11">1.1  <strong>结果解读</strong><a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<p>注意应用回归模型时研究自变量是否产生变化</p>
<p>在应用回归模型做预测时，必须研究对因变量产生影响的自变量是否产生变化，主要考察两个方面：</p>
<ul>
<li>是否产生了新的对因变量影响更大的自变量</li>
</ul>
<p>在建立回归模型时，需要综合考虑自变量的选择问题。如果遗漏了重要的变量，那么模型很可能无法正确反映实际情况，而且参数估计是有偏的，此时的回归模型极其不稳定且方差较大。</p>
<p>同样在应用回归模型时，仍然需要重新评估该问题是否发生。例如，在做用户订单金额预测时是基于正常销售状态下的变量实现的；但当发生大型促销活动且促销活动因素没有被纳入回归模型中时，原来的回归模型则无法有效预测。</p>
<ul>
<li>原有自变量是否仍然控制在训练模型时的范围之内。</li>
</ul>
<p>如果有自变量的变化超过训练模型的范围，那么原来的经验公式可能无法在新的值域范围下适用，这种情况下通常需要重新做研究和建模。</p>
<p>假设我们建立了一个回归模型，可以广告投放费用预测广告点击率，在训练回归模型时的广告费用在[0，1000]区间内，但在广告费用超过1000（例如2000）时，则无法保证最终预测效果的有效性。</p>
<p>​   回归算法按照自变量的个数分为一元回归和多元回归，按照影响是否是线性分为线性回归和非线性回归。在面对不同回归方法的选择时，注意参考以下因素：</p>
<p>（1）入门的开始——简单线性回归。如果是学习为主，那么不需要选择多么强大的模型，基于最小二乘法的普通线性回归最合适；同时，它适合数据集本身结构简单、分布规律有明显线性关系的场景。</p>
<p>（2）如果自变量数量少或经过降维后得到了可以使用的二维变量（包括预测变量），那么可以直接通过散点图发现自变量和因变量的相互关系，然后选择最佳回归方法。</p>
<p>（3）如果经过基本判断发现自变量间有较强的共线性关系，可以考虑岭回归。</p>
<p>（4）如果在高维度变量下，使用正则化回归方法效果更好，例如Lasso、Ridge</p>
<p>（5）如果注重模型的可解释性，那么容易理解的线性回归、多项式回归比较适合。</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "search": "../assets/javascripts/workers/search.092fa1f6.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.5a9542cf.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../js/extra.js"></script>
      
    
  </body>
</html>